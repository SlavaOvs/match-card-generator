<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Генератор карточек матча</title>
  <style>
    /* Oswald Font */
    @font-face {
      font-family: 'Oswald';
      font-style: normal;
      font-weight: 500;
      src: url('Oswald/static/Oswald-Medium.ttf') format('truetype');
    }
    body {
      font-family: 'Oswald', sans-serif;
      max-width: 480px;
      margin: 0 auto;
      padding: 1rem;
    }
    label, input, select, button {
      display: block;
      width: 100%;
      margin-bottom: .75rem;
    }
    .date-inputs { display: flex; gap: .5rem; }
    .date-inputs input,
    .date-inputs select { flex: 1; }
    .canvas-wrapper {
      width:100%; max-width:480px; margin:1rem auto;
      overflow:hidden;
    }
    canvas {
      display:block; width:100%; height:auto;
      border:1px solid #ccc; box-sizing:border-box;
    }
    button { padding:.5rem; font-size:1rem; }
    #progress { text-align:center; margin-top:.5rem; font-weight:bold; }
    a#downloadLink { display:none; text-align:center; margin-top:1rem; }
    /* Awesomplete skin */
    .awesomplete { position:relative; display:inline-block; }
    .awesomplete > ul {
      position:absolute; left:0; top:100%; right:0;
      margin:.2em 0 0; padding:0; list-style:none;
      background:#fff; border:1px solid #ccc;
      box-shadow:0 4px 8px rgba(0,0,0,.1);
      max-height:200px; overflow-y:auto;
    }
    .awesomplete li { padding:.4em .6em; cursor:pointer; }
    .awesomplete li[aria-selected="true"],
    .awesomplete li:hover { background:#eee; }
  </style>

  <!-- Awesomplete -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.css" />
  <script defer
    src="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.js"></script>
</head>
<body>
  <h1>Генератор карточек матча</h1>

  <label>Команда хозяев:
    <input id="homeTeam" class="awesomplete" placeholder="Начните вводить..." />
  </label>
  <label>Команда гостей:
    <input id="awayTeam" class="awesomplete" placeholder="Начните вводить..." />
  </label>
  <label>Лига:
    <input id="league" class="awesomplete" placeholder="Начните вводить..." />
  </label>

  <label>Дата матча:</label>
  <div class="date-inputs">
    <input type="number" id="matchDay" min="1" max="31" placeholder="День" />
    <select id="matchMonth">
      <option value="0">ЯНВАРЯ</option>
      <option value="1">ФЕВРАЛЯ</option>
      <option value="2">МАРТА</option>
      <option value="3">АПРЕЛЯ</option>
      <option value="4">МАЯ</option>
      <option value="5">ИЮНЯ</option>
      <option value="6">ИЮЛЯ</option>
      <option value="7">АВГУСТА</option>
      <option value="8">СЕНТЯБРЯ</option>
      <option value="9">ОКТЯБРЯ</option>
      <option value="10">НОЯБРЯ</option>
      <option value="11">ДЕКАБРЯ</option>
    </select>
  </div>

  <label for="matchTime">Время матча:</label>
  <input type="time" id="matchTime" />

  <label><input type="checkbox" id="addLogoHp" /> Добавить логотип Hockey Plus</label>
  <label><input type="checkbox" id="showVS" /> Показать "VS"</label>

  <button id="generate">Сгенерировать карточку</button>
  <div id="progress"></div>
  <a id="downloadLink">Скачать PNG</a>

  <div class="canvas-wrapper">
    <canvas id="preview" width="2000" height="2000"></canvas>
  </div>

  <script>
    // ==== Настройки позиций ====
    const logoCenterY = 900,       // центр командных логотипов
          dateGapPx   = 120,       // лучший отступ (пикселей) под ЛОГОТИПОМ ЛИГИ до даты
          lineHeight  = 60 * 1.2;   // 120% межстрочный для даты
    // ==============================

    // команды с путями
    const teams = [
      { name:'Сиэтл Кракен',       logo:'images/Команды/Сиэтл Кракен.png' },
      { name:'Эдмонтон Ойлерз',    logo:'images/Команды/Эдмонтон Ойлерз.png' },
      { name:'ЦСКА Москва',        logo:'images/Команды/ЦСКА Москва.png' },
      { name:'Вашингтон Кэпиталз', logo:'images/Команды/Вашингтон Кэпиталз.png' },
      { name:'Флорида Пантерз',    logo:'images/Команды/Флорида Пантерз.png' },
      { name:'Каролина Харрикейнз',logo:'images/Команды/Каролина Харрикейнз.png' },
      { name:'Вегас Голден Найтс', logo:'images/Команды/Вегас Голден Найтс.png' },
      { name:'Торонто Мэйпл Лифс', logo:'images/Команды/Торонто Мэйпл Лифс.png' },
      { name:'Виннипег Джетс',     logo:'images/Команды/Виннипег Джетс.png' },
      { name:'Даллас Старз',       logo:'images/Команды/Даллас Старз.png' }
    ];

    // лиги с путями
    const leagues = [
      { name:'НХЛ',                logo:'images/Лиги/НХЛ.png',               x:118, y:50 },
      { name:'КХЛ',                logo:'images/Лиги/КХЛ.png',               x:121, y:50 },
      { name:'Чемпионат Беларуси', logo:'images/Лиги/ЧемпионатБеларуси.png', x:60,  y:50 },
      { name:'Чемпионат мира',     logo:'images/Лиги/Чемпионатмира.png',     x:83,  y:50 },
      { name:'МХЛ',                logo:'images/Лиги/МХЛ.png',               x:114, y:50 },
      { name:'ВХЛ',                logo:'images/Лиги/ВХЛ.png',               x:121, y:50 }
    ];

    // инициализация автокомплита (Awesomplete)
    document.addEventListener('DOMContentLoaded',()=>{
      ['homeTeam','awayTeam'].forEach(id=>{
        const inp=document.getElementById(id);
        const aw=new Awesomplete(inp,{
          list:teams.map(t=>t.name),
          minChars:0, autoFirst:true
        });
        inp.addEventListener('focus',()=>aw.evaluate());
      });
      const inpL=document.getElementById('league');
      const awL=new Awesomplete(inpL,{
        list:leagues.map(l=>l.name),
        minChars:0, autoFirst:true
      });
      inpL.addEventListener('focus',()=>awL.evaluate());
    });

    // загрузка с прогрессом
    function loadImage(url,onProg){
      return new Promise((res,rej)=>{
        const img=new Image();
        img.crossOrigin='anonymous';
        img.onload=()=>{ onProg&&onProg(); res(img); };
        img.onerror=()=>rej(url);
        img.src=url;
      });
    }

    // рисуем карточку
    async function drawCard(){
      const prog=document.getElementById('progress');
      prog.textContent='';

      await document.fonts.load('500 10px Oswald');

      const h=document.getElementById('homeTeam').value,
            a=document.getElementById('awayTeam').value,
            l=document.getElementById('league').value,
            d=document.getElementById('matchDay').value,
            m=document.getElementById('matchMonth').value,
            t=document.getElementById('matchTime').value,
            hp=document.getElementById('addLogoHp').checked,
            vs=document.getElementById('showVS').checked;

      if(!h||!a||!l||!d||m===''||!t){
        alert('Заполните все поля'); return;
      }

      const selH=teams.find(x=>x.name===h),
            selA=teams.find(x=>x.name===a),
            selL=leagues.find(x=>x.name===l);

      let urls=['images/Фон/Фон.png', selH.logo, selA.logo, selL.logo];
      if(hp) urls.push('images/Hockey Plus/Лого.png');

      let loaded=0, total=urls.length;
      const onProg=()=>{ loaded++; prog.textContent=`${(loaded/total*100).toFixed(1)}%`; };

      const [bg,imgH,imgA,imgL,imgHP]=await Promise.all(
        urls.map(u=>loadImage(u,onProg))
      );

      const c=document.getElementById('preview'),
            ctx=c.getContext('2d');
      ctx.clearRect(0,0,c.width,c.height);

      // фон и лого
      ctx.drawImage(bg,0,0,c.width,c.height);
      ctx.drawImage(imgH,  500  - imgH.width/2, logoCenterY - imgH.height/2);
      ctx.drawImage(imgA, 1500 - imgA.width/2, logoCenterY - imgA.height/2);
      ctx.drawImage(imgL, selL.x, selL.y);
      if(hp) ctx.drawImage(imgHP,850,1850);

      // текст
      ctx.fillStyle='#fff';
      ctx.textAlign='center';
      ctx.textBaseline='top';
      if(vs){
        ctx.font='500 100px Oswald';
        ctx.textAlign='left';
        ctx.fillText('VS',950,950);
      }

      // дата и время под логотипом лиги
      const leagueBot=selL.y + imgL.height,
            dateY=leagueBot + dateGapPx;
      const months=['ЯНВАРЯ','ФЕВРАЛЯ','МАРТА','АПРЕЛЯ','МАЯ','ИЮНЯ',
                    'ИЮЛЯ','АВГУСТА','СЕНТЯБРЯ','ОКТЯБРЯ','НОЯБРЯ','ДЕКАБРЯ'];
      const dateText=String(d).padStart(2,'0')+' '+months[m];

      ctx.font='500 60px Oswald';
      ctx.fillText(dateText,c.width/2,dateY);
      ctx.font='500 116px Oswald';
      ctx.fillText(t,     c.width/2,dateY+lineHeight+1);

      prog.textContent='100.0% — готово!';
      const link=document.getElementById('downloadLink');
      link.href    =c.toDataURL('image/png');
      link.download=`${h}_vs_${a}.png`;
      link.style.display='block';
    }

    document.getElementById('generate').addEventListener('click',drawCard);
  </script>
</body>
</html>
